id: ArchiveAssets
name: Archive Assets
description: <__trans phrase="Allowing users to upload Archives into their Movable Type.">
schema_version: 1
version: 0.1
l10n_class: ArchiveAssets::L10N

object_types:
  asset.archive: MT::Asset::Archive
  archive: MT::Asset::Archive
settings:
  insert_pagetracker:
    default: 1
    scope: blog
  delete_extracted:
    default: 0
    scope: blog
#  overwrite_extracts:
#    default: 1
#    scope: blog
blog_config_template: >
    <p>
      <label for="insert_pagetracker"><__trans phrase="Insert GoogleAnalytics PageTracker code:"></label>
      <input type="checkbox" name="insert_pagetracker" value="1"<mt:if name="insert_pagetracker"> checked="checked"</mt:if> />
    </p>
    <p>
      <label for="delete_extracted"><__trans phrase="Extract and Delete Archives:"></label>
      <input type="checkbox" name="delete_extracted" value="1"<mt:if name="delete_extracted"> checked="checked"</mt:if> />
    </p>
    #<p>
    #  <label for="overwrite_extracts"><__trans phrase="Overwrite Extracted Files:"></label>
    #  <input type="checkbox" name="overwrite_extracts" value="1"<mt:if name="overwrite_extracts"> checked="checked"</mt:if> />
    #</p>
callbacks:
  MT::App::CMS::template_param.asset_options:   $ArchiveAssets::ArchiveAssets::Plugin::_cb_param_asset_options
  MT::App::CMS::template_param.edit_asset:      $ArchiveAssets::ArchiveAssets::Plugin::_cb_param_edit_asset
#  MT::App::CMS::template_param.asset_insert:    $ArchiveAssets::ArchiveAssets::Plugin::_cb_param_asset_insert
  cms_pre_save.asset:             $ArchiveAssets::ArchiveAssets::Plugin::_cb_cms_pre_save_asset
  cms_upload_file.archive:           $ArchiveAssets::ArchiveAssets::Plugin::_cb_cms_upload_archive
  MT::App::CMS::template_param.asset_upload:    $ArchiveAssets::ArchiveAssets::Plugin::_cb_param_asset_upload
  MT::App::CMS::template_source.asset_replace:  $ArchiveAssets::ArchiveAssets::Plugin::_cb_source_asset_replace
#  cms_filtered_list_param.asset:  $ArchiveAssets::ArchiveAssets::Plugin::_cb_cms_filtered_list_param_asset
applications:
  cms:
    page_actions:
      asset:
        extract_archive: 
          label: 'Extract Archive'
          order: 100
          mode: extract_current
          permission: upload
          condition: $ArchiveAssets::ArchiveAssets::Plugin::_is_archive
    list_actions:
      asset:
        extract:
          label: Extract
          code: $ArchiveAssets::ArchiveAssets::Plugin::extract_asset
          order: 400
          permission: upload
          js_message: extract
    methods:
      extract_current: $ArchiveAssets::ArchiveAssets::Plugin::extract_current
